// XML Menu Scroller Add-on Module (v 1.2)

// THIS FILE MAY NOT BE MODIFIED

// Copyright (C) 2007 XmlMenu.com. All rights reserved


function XMScroller(){var b="-disabled",g="-over",V="-up",a="-down",d="xm-scroll",w=d+V,u=w+b,I=d+a,O=I+b,Y="px",r=0,h=10,c=20,T=500,M=50,o=window.XmlMenu,Q=document,v="xmscr",R=arguments.callee;R.scrollDown=function(id){H=Q.getElementById(id);H.btnUp.className=w;var P=Math.min(H.XS.maxHeight-H.XS.q,c);H.XS.W-=P;H.XS.S+=P;H.XS.q+=P;H.style.top=H.XS.W+Y;x(H,H.XS.S,H.XS.q);if(H.XS.q==H.XS.maxHeight){H.btnDown.className=O;L(H);}else if(!H.XS.y)H.XS.y=setInterval('XMScroller.scrollDown("'+id+'")',H.XS.scrollDelay);};R.scrollUp=function(id){H=Q.getElementById(id);H.btnDown.className=I;var P=Math.min(H.XS.S,c);H.XS.W+=P;H.XS.S-=P;H.XS.q-=P;H.style.top=H.XS.W+Y;x(H,H.XS.S,H.XS.q);if(H.XS.S==0){H.btnUp.className=u;L(H);}else if(!H.XS.y)H.XS.y=setInterval('XMScroller.scrollUp("'+id+'")',H.XS.scrollDelay);};this.attachScroller=function(K,H){H.XS={};H.id=v+r++;K.appendChild(H.btnUp=n(u,H));K.appendChild(H.btnDown=n(I,H));};this.makeScrollable=function(A,i,H,top,U,k){var btnUp=H.btnUp,btnDown=H.btnDown;H.XS.A=A;if(o.IE<7)btnUp.style.padding=btnDown.style.padding=0;btnUp.style.width=btnDown.style.width=H.offsetWidth+Y;if(!k)top+=h;btnUp.style.top=top-A+Y;l(btnDown,9);btnDown.style.top=U-btnDown.offsetHeight-h-A-i+Y;l(btnUp,9);btnUp.style.left=btnDown.style.left=H.style.left;btnUp.style.zIndex=btnDown.style.zIndex=parseInt(H.style.zIndex)+1;x(H,0,btnDown.offsetTop-btnUp.offsetTop);return btnUp.offsetHeight+top;};this.hide=function(H){if(H.btnUp.style.display=="block"){x(H,0,H.offsetHeight);H.XS.j=0;H.btnUp.className=u;H.btnDown.className=I;l(H.btnUp);l(H.btnDown);}};function n(C,H){var E=Q.createElement("div");E.H=H;E.style.position="absolute";E.className=C;l(E);function N(){return E.className.indexOf(b)==-1;}E.onmousedown=function(){if(N()){L(H);J(E,H,G());}};E.onmouseup=function(){if(N()){L(H);J(E,H,z());}};E.onmouseout=function(){if(N()){E.className=E.className.replace(g,"");L(H);}};E.onmouseover=function(){if(N()){E.className=E.className+g;J(E,H,z());}};return E;}function l(E,Z){E.style.display=Z?"block":"none";}function x(H,top,bottom){var left,right;if(o.KO){left=H.offsetWidth+Y;right=0;}else left=right="auto";H.style.clip="rect("+top+"px,"+left+","+bottom+"px,"+right+")";}function J(E,H,F){if(!H.XS.j){H.XS.j=9;H.XS.W=(H.btnDown.offsetHeight+H.btnUp.offsetHeight)-H.XS.A;H.XS.maxHeight=H.offsetHeight+H.XS.W-H.btnUp.offsetHeight+H.XS.A;H.XS.S=H.offsetTop-H.XS.W;H.XS.q=H.btnDown.offsetTop-H.btnUp.offsetHeight+H.XS.A;}H.XS.scrollDelay=F;if(E==H.btnUp)R.scrollUp(H.id);else R.scrollDown(H.id);}function L(H){if(H.XS.y){clearInterval(H.XS.y);H.XS.y=0;}}function z(){return R.mouseOverDelay?R.mouseOverDelay:T;}function G(){return R.mouseDownDelay?R.mouseDownDelay:M;}}